# 进程控制块（PCB，Process Control Block）

---

## 1. 什么是 PCB？

* PCB 是操作系统内核为管理每个进程而维护的**核心数据结构**。
* 它包含了操作系统需要的所有与该进程相关的信息。
* 可以把它看作“进程的身份证”和“档案”，用于跟踪进程状态和资源使用情况。

---

## 2. PCB 中包含哪些主要信息？

| 信息类别          | 说明                              |
| ------------- | ------------------------------- |
| **进程标识信息**    | 进程ID（PID）、父进程ID、用户ID、组ID等       |
| **进程状态**      | 新建、就绪、运行、阻塞、终止等状态               |
| **程序计数器（PC）** | 指向进程下一条要执行的指令地址                 |
| **CPU寄存器内容**  | 进程切换时保存的寄存器值（通用寄存器、堆栈指针、程序状态字等） |
| **内存管理信息**    | 进程的页表、段表、基址寄存器、界限寄存器等           |
| **文件管理信息**    | 该进程打开的文件描述符表（文件列表）              |
| **调度信息**      | 进程优先级、调度队列指针、时间片等               |
| **账户信息**      | CPU 时间使用情况、计费信息等                |
| **信号和通信信息**   | 信号处理、消息队列、管道等相关信息               |

---

## 3. PCB 的作用

* **进程管理**：操作系统根据 PCB 进行进程的创建、调度、切换和销毁。
* **进程切换**：切换进程时保存和恢复 PCB 中的状态，保证进程连续执行。
* **资源管理**：记录进程所占用的资源，方便系统回收和调度。

---

## 4. PCB 的生命周期

* 当创建一个新进程时，操作系统创建对应的 PCB 并初始化。
* 进程运行过程中，PCB 的内容会不断更新（状态、寄存器、资源等）。
* 进程终止后，操作系统释放 PCB 和占用的资源。

---

## 5. PCB 在系统中的位置

* PCB 存放在操作系统内核空间。
* 每个进程对应一个 PCB。
* 操作系统通过 PCB 来实现进程调度和管理。

---

## 简单示意图

```
+-----------------------+
| Process Control Block  |
+-----------------------+
| PID: 1234             |
| State: Running        |
| PC: 0x00401000        |
| Registers: ...        |
| Memory info: ...      |
| File descriptors: ... |
| Priority: 5           |
| ...                   |
+-----------------------+
```

---
线程ID（Thread ID，简称TID）通常也是存放在类似PCB的线程控制块（TCB，Thread Control Block）中。

---

* **线程控制块（TCB）** 是操作系统用来管理线程的核心数据结构，类似于进程的PCB。
* 每个线程都有自己的TCB，里面保存了该线程的所有信息，包括**线程ID（TID）**。
* 线程ID用于唯一标识系统中的线程。

---

## 关系

| 组件                       | 说明                  |
| ------------------------ | ------------------- |
| PCB                      | 管理进程信息              |
| TCB                      | 管理线程信息              |
| TCB 中含有线程ID（TID）         | 标识线程的唯一ID           |
| 一个进程（PCB）可以包含多个线程（多个TCB） | 多线程共享进程的资源，但有独立的TCB |

---

## 总结

* 线程ID（TID）存储在线程控制块（TCB）中。
* 操作系统通过TCB管理线程调度和状态。
* PCB管理进程，TCB管理线程，线程ID在TCB内。
