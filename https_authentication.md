### 一、HTTPS 的认证握手过程（以 TLS 为基础）

HTTPS 实际上就是 HTTP over TLS/SSL，它在 HTTP 与 TCP 之间增加了一层安全协议（TLS）。握手过程主要负责：

TLS（Transport Layer Security, 传输层安全协议）, SSL（Secure Sockets Layer）。

- **身份验证**
- **协商加密算法**
- **生成对称密钥**

#### 简化的握手流程如下（以 TLS 1.2 为例）：

1. **客户端发起请求（Client Hello）**  
   客户端发送支持的 TLS 版本、加密算法列表、随机数等。

2. **服务器响应（Server Hello）**  
   服务器选择加密算法，返回自己的证书（包含公钥）、随机数等。

3. **服务器证书验证**  
   客户端用操作系统内置的 CA 根证书去验证服务器证书的合法性（证书是否被篡改、是否过期、是否被吊销等）。

4. **生成对称密钥**  
   客户端生成一个“预主密钥”（pre-master key），用服务器的公钥加密后发送给服务器。

5. **双方生成会话密钥（Session Key）**  
   双方基于两端的随机数和预主密钥计算出相同的对称密钥。

6. **握手完成**  
   后续通信使用这个对称密钥进行加密，提高效率。

---

#### ✅ **单向认证**（最常见，默认使用）：

- **认证对象**：只有客户端验证服务器。
- **使用场景**：大多数网站（如百度、淘宝、Google）都使用单向认证。
- **过程**：
  - 服务器向客户端提供证书，客户端验证其合法性。
  - 客户端无需提供证书。

**优点**：部署简单，用户访问方便。  
**缺点**：不能验证客户端身份，服务器无法确定客户端是谁。

---

#### ✅ **双向认证**（又叫双向 TLS 或 Mutual TLS）：

- **认证对象**：客户端和服务器互相认证。
- **使用场景**：银行、企业内部系统、API 网关等高安全性场景。
- **过程**：
  - 在单向认证的基础上，**客户端也向服务器提供证书**。
  - 服务器验证客户端证书的合法性。

**优点**：安全性高，能防止非法客户端接入。  
**缺点**：部署复杂，客户端必须持有证书，管理成本高。

---

### 三、总结表格：

| 对比项       | 单向认证                 | 双向认证                 |
|--------------|--------------------------|--------------------------|
| 验证方向     | 客户端验证服务器         | 客户端和服务器互相验证   |
| 客户端证书   | 不需要                   | 必须提供                 |
| 安全性       | 一般                     | 高                       |
| 使用场景     | 网站访问、普通 APP 接入  | 银行系统、企业私有系统   |
| 实现复杂度   | 低                       | 高                       |

---