
## 1️⃣ 本地劫持（Local DNS Hijacking）

### 📌 原理：

攻击者在**你的电脑本地**动手脚，修改 DNS 设置或 hosts 文件，把合法域名解析到错误地址。

### 🔧 实施方式：

* 安装恶意软件或木马
* 修改系统 `hosts` 文件（优先于DNS查询）
* 篡改网络配置，将 DNS 设置为攻击者控制的服务器

### 🎯 举例：

你访问 `www.bank.com`，但 `hosts` 文件中被添加了一行：

```
203.0.113.5  www.bank.com
```

你就会被重定向到一个伪装的钓鱼银行网站。

### 🛡️ 防范方法：

* 安装可靠杀毒软件和防火墙
* 定期检查系统 DNS 设置是否被篡改
* 不轻易安装未知来源的软件
* 在 Windows 中查看 `C:\Windows\System32\drivers\etc\hosts`

---

## 2️⃣ 运营商劫持（ISP-level DNS Hijacking）

### 📌 原理：

你的 DNS 查询经过运营商的网络时，被运营商或第三方篡改了响应，返回**自定义或广告页面**。

### 🔧 实施方式：

* 运营商 DNS 服务器返回虚假 IP（通常用于广告或屏蔽）
* 中间网络设备劫持 DNS 请求包，注入错误回应

### 🎯 举例：

你访问一个拼写错误的域名如 `gooogle.com`，原本应该显示“找不到网页”，但却跳转到运营商的搜索页面或广告。

### 🛡️ 防范方法：

* 使用可信第三方 DNS（如 Google、Cloudflare、Quad9）
* 开启加密 DNS（DoH/DoT）
* 使用 VPN（可绕过运营商控制）

---

## 3️⃣ DNS 缓存投毒（DNS Cache Poisoning）

### 📌 原理：

攻击者向一个合法 DNS 服务器注入**伪造的解析记录**，污染缓存，让用户得到错误解析结果。

### 🔧 实施方式：

* 向 DNS 服务器发送大量请求 + 伪造响应
* 命中服务器缓存机制，成功注入假的 IP 地址

### 🎯 举例：

攻击者让 DNS 缓存中 `www.bank.com` 的记录变成：

```
www.bank.com -> 203.0.113.5
```

之后所有用户访问该银行网站都会被重定向到假的 IP，直到缓存过期。

### 🛡️ 防范方法：

* 使用支持 **DNSSEC** 的 DNS 服务（防止伪造记录）
* 关闭不必要的 DNS 递归功能
* 定期清除和更新 DNS 缓存

---

## 4️⃣ 中间人攻击（Man-in-the-Middle, MITM）

### 📌 原理：

攻击者在你和 DNS 服务器之间“监听并篡改” DNS 请求和响应，实现即时劫持。

### 🔧 实施方式：

* 局域网中设置伪造热点（如公共WiFi）
* ARP 欺骗或 DNS 代理，拦截 DNS 请求并伪造回应

### 🎯 举例：

你连上了一个咖啡店的假WiFi，攻击者拦截你的 DNS 查询，返回：

```
www.bank.com -> 203.0.113.5
```

你以为是官网，其实是钓鱼站。

### 🛡️ 防范方法：

* 使用 HTTPS 网站（DNS劫持后仍需证书验证）
* 不使用不安全的 WiFi，或使用 VPN
* 使用加密 DNS（如 DNS-over-HTTPS）

---

## 📊 总结对比表

| 劫持方式    | 发生位置   | 主要手段        | 防范重点              |
| ------- | ------ | ----------- | ----------------- |
| 本地劫持    | 用户设备   | hosts、DNS篡改 | 杀毒、防火墙、权限管理       |
| 运营商劫持   | 网络运营商  | DNS响应修改/拦截  | 使用第三方DNS、开启加密DNS  |
| DNS缓存投毒 | DNS服务器 | 注入伪造记录      | 使用DNSSEC、限制递归、清缓存 |
| 中间人攻击   | 网络中间链路 | 拦截+伪造DNS响应  | VPN、HTTPS、加密DNS   |

---